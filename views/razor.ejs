<!-- Inside index.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      content="This is a demo of Web integration  
        of Razorpay in NodeJS"
      author="Mr. Twinkle Sharma"
    />
    <title>Razorpay Web-Integration</title>
  </head>

  <body>
    <hr />
    <h2>Advanced Data Structures & Algorithms Course</h2>
    <h3>Description</h3>

    <ul>
      <li>Best Course for SDE placements</li>
      <li>Available in 4 major Languages JAVA, C/C++, Python, Javascript</li>
      <li>Lifetime Access</li>
    </ul>

    <span>
      Cost:- 499 Rupees
      <button id="pay-button">Pay Now & Get Access</button>
    </span>
    <hr />
    <!--Inside index.html -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
      document.getElementById("pay-button").onclick = function (e) {
        const xhr = new XMLHttpRequest();

        xhr.open("POST", "/razor");
        xhr.send();

        xhr.onload = async function () {
          if (xhr.status === 200) {
            // Success!
            logg = JSON.parse(xhr.responseText);
            console.log(logg.id);

            console.log(JSON.stringify(options));
            var options = {
              key: "rzp_test_OxMtoc8hYbDMso",
              amount: logg.amount * 100,
              currency: "INR",
              name: "Dummy Academy",
              description: "Pay & Checkout this Course, Upgrade your DSA Skill",
              image:
                "https://media.geeksforgeeks.org/wp-content/uploads/20210806114908/dummy-200x200.png",
              order_id: logg.id,
              //   order_id: "order_MoLLxrlXrcCcTR",
              handler: function (response) {
                console.log(response);
                alert("This step of Payment Succeeded");
              },
              prefill: {
                //Here we are prefilling random contact
                contact: "9876543210",
                //name and email id, so while checkout
                name: "Twinkle Sharma",
                email: "smtwinkle@gmail.com",
              },
              notes: {
                description: "Best Course for SDE placements",
                language:
                  "Available in 4 major Languages JAVA,C/C++, Python, Javascript",
                access: "This course have Lifetime Access",
              },
              theme: {
                color: "#2300a3",
              },
            };
            var razorpayObject = new Razorpay(options);
            console.log(razorpayObject);
            razorpayObject.on("payment.failed", function (response) {
              console.log(response);
              alert("This step of Payment Failed");
            });
            razorpayObject.open();
            e.preventDefault();
          } else {
            // Error!
            console.log("here :", xhr.statusText);
          }
        };
      };
    </script>
  </body>
</html>
